@echo off
rem this file has been generated by batchgen and may be overwritten
rem command line: batchgen -orb doLexYacc.bg
rem date 2011-0-8 16:03:50

@goto main
rem sub routine
:finalise

set DLY_DEBUG=
set DLY_HELP=
set DLY_LEX_FLAGS=
set DLY_YACC_FLAGS=
set DLY_LEX_FILE=
set DLY_GRAMMAR_FILE=
set DLY_FLEX=
set DLY_YACC=
set DLY_TERMINATE=

rem end sub routine
goto :eof

rem sub routine
:usage

echo usage %0 [options]

echo options
echo     -d     include debugging code for lexer and parser
echo     -h     this screen
set DLY_TERMINATE=yes

rem end sub routine
goto :eof

rem sub routine
:getopts
rem while
:WH0
if not "%1" == "" goto WB0
goto EW0
:WB0
if "%1" == "-d" goto IF0
goto EI0
:IF0
 set DLY_DEBUG=True 
rem endif
:EI0
if "%1" == "-h" goto IF1
goto EI1
:IF1
 set DLY_HELP=True 
rem endif
:EI1
 shift  
goto WH0
rem endwhile
:EW0
rem end sub routine
goto :eof

rem sub routine
:initialise

rem set DEBUG=<anything> gets a debug build
set DLY_DEBUG=
set DLY_HELP=
set DLY_TERMINATE=
set DLY_LEX_FILE=batchgen.l
set DLY_GRAMMAR_FILE=batchgen.y

rem edit these to suit
set DLY_FLEX="C:\Program Files (x86)\GnuWin32\bin\flex.exe"
set DLY_YACC="C:\Program Files (x86)\GnuWin32\bin\yacc.exe"

rem end sub routine
goto :eof

:main
call :initialise

call :getopts %* 
pushd I:\usr\NIK\dev\batchgen\source

if "%DLY_HELP%" == "True" goto IF2
goto EI2
:IF2
call :usage
rem endif
:EI2
if "%DLY_TERMINATE%" == "yes" goto IF3
goto EI3
:IF3
goto batch_end
rem endif
:EI3
if "%DLY_DEBUG%" == "" goto IF4
goto LS4
:IF4

    set DLY_LEX_FLAGS=
    set DLY_YACC_FLAGS= -tdv
    set YYDEBUG=


goto EI4
rem else
:LS4

    set DLY_LEX_FLAGS=-d
    set DLY_YACC_FLAGS=-ldv
    set YYDEBUG=1

rem endif
:EI4

@echo on
%DLY_YACC% %DLY_YACC_FLAGS% %DLY_GRAMMAR_FILE%
%DLY_FLEX% %DLY_LEX_FLAGS% %DLY_LEX_FILE%
@echo off

sed "/extern char \*getenv();/d" y.tab.c > junk
del y.tab.c
mv junk y.tab.c

move y.output ..\doc\y.output > nul
popd

call :finalise
:batch_end
