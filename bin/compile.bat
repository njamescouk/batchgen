@echo off
rem this file has been generated by batchgen and may be overwritten
rem command line: batchgen -orb compile.bg
rem date 2011-0-8 22:46:39

@goto main
:usage
echo usage %0 [options]
echo .
echo options
 -d  -d  -d     include debugging code for lexer and parser
echo     -h     help
goto :eof
:getopts
if "%1" == "" goto EW0
if not "%1" == "-d" goto LS1
 set BGCOMP_DEBUG=True
goto EI0
:LS1
if not "%1" == "-h" goto LS0
set BGCOMP_HELP=True
goto EI0
:LS0
set BGCOMP_ILLEGAL_OPT=True
:EI0
 shift 
goto getopts
:EW0
goto :eof
:finalise
set BGCOMP_DEBUG=
set BGCOMP_HELP=
set BGCOMP_ILLEGAL_OPT=
set CC_FLAGS=
set BGCOMP_SOURCE_FILES=
set CC=
goto :eof
:initialise
set BGCOMP_DEBUG=
set BGCOMP_HELP=
set BGCOMP_ILLEGAL_OPT=
set CC_FLAGS=
set BGCOMP_SOURCE_FILES=batchgen.c bkpatch.c fileread.c lex.yy.c optim.c sr.c stacks.c y.tab.c
set CC=c:\bin\MinGWNew\bin\gcc.exe
goto :eof
:main
call :initialise
call :getopts
if "%BGCOMP_HELP%" == "True" goto IF4
if not "%BGCOMP_ILLEGAL_OPT%" == "True" goto LS4
:IF4
call :usage
goto batch_end
:LS4
if not "%BGCOMP_DEBUG%" == "" goto LS2
       call doLexYacc
       set CC_FLAGS=%CC_FLAGS% -D WIN32 -D NDEBUG -D _CONSOLE -obatchgen.exe
       set YYDEBUG=
goto EI2
:LS2
       call doLexYacc -d
       set CC_FLAGS=%CC_FLAGS% -D WIN32 -D _CONSOLE -D DEBUG -D YYDEBUG  -obatchgen_debug.exe
       set YYDEBUG=1
:EI2
    pushd I:\usr\NIK\dev\batchgen\source
    markupgrammar -f batchgen.y > ..\doc\batchgen.y.html
    markupgrammar -f batchgen.y -d > ..\doc\batchgen.y.dot
    markupgrammar -f ..\source\batchgen.y -x > ..\doc\batchgen.y.docbook.xml
    @echo on
    %CC% %CC_FLAGS% %BGCOMP_SOURCE_FILES%
    @echo off
    del *.obj > nul
    pushd I:\usr\NIK\dev\batchgen\doc
    dot -O -Tpng batchgen.y.dot
    popd
if not "%BGCOMP_DEBUG%" == "" goto LS3
       move batchgen.exe ..\bin
goto EI3
:LS3
       move batchgen_debug.exe ..\bin
:EI3
 popd 
call :finalise
:batch_end
